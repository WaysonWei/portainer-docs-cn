# 设置

**主机设置**部分仅适用于Docker独立环境。

在**设置**下，您可以对环境进行更改，启用和禁用功能及安全设置。

## 主机和文件系统

对于运行Portainer Agent的环境，此部分配置Portainer如何与主机元素交互。

出于安全考虑，这些功能默认禁用。启用前请确保了解其影响。

<figure><img src="../..//assets/2.22.0-host-setup-filesystem.png" alt=""><figcaption></figcaption></figure>

### 启用主机管理功能

启用主机管理功能允许您查看物理节点上的可用设备和存储，以及浏览节点的文件系统。环境必须[运行Portainer Agent](../../../start/agent.md)才能使用此功能，并且主机的根目录必须绑定挂载到agent部署中的`/host`：

```
-v /:/host
```

例如，在Linux上的Docker中启动Portainer Agent，并将主机文件系统挂载在`/host`：

```
docker run -d -p 9001:9001 --name portainer_agent --restart=always -v /var/run/docker.sock:/var/run/docker.sock -v /var/lib/docker/volumes:/var/lib/docker/volumes -v /:/host portainer/agent:2.22.0
```

### 为非管理员启用卷管理

启用此功能允许非管理员用户管理环境上的卷。如果禁用，管理员级别以下的用户对卷只有只读访问权限。

## 变更窗口设置

此设置允许您指定一个时间窗口，在此窗口内可以应用对应用程序的[GitOps更新](../stacks/add.md#gitops-updates)。

如果启用此设置并在窗口外对应用程序进行更新，则不会应用该更新。

<figure><img src="../..//assets/2.19-kubernetes-cluster-setup-changewindow.png" alt=""><figcaption></figcaption></figure>

## Docker安全设置

此部分允许您切换环境的各类Docker相关安全设置。

<figure><img src="../..//assets/2.15-docker_hosts_security_settings.png" alt=""><figcaption></figcaption></figure>

| 选项                                                | 概述                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| ----------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 为非管理员禁用绑定挂载            | 防止Portainer中的非管理员用户在创建容器和/或服务/堆栈时使用绑定挂载。切换开启时，附加到主机文件系统路径的选项将被移除。                                                                                                                                                                                                                                                                                                                                                              |
| 为非管理员禁用特权模式        | 防止非管理员用户提升容器的权限以绕过SELinux/AppArmor。切换开启时，[添加容器](../containers/add.md)时选择**特权**模式的选项将被移除。                                                                                                                                                                                                                                                                                                                                      |
| 为非管理员禁用使用主机PID 1  | 防止非管理员用户请求部署的容器作为主机PID运行。如果被不可信授权用户使用，这是一个安全风险，因为当他们作为PID1运行时，实际上能够在容器控制台中以root身份在主机上运行任何命令。                                                                                                                                                                                                                                                               |
| 为非管理员禁用使用堆栈      | 这是一种"大锤"方法，用于消除Portainer中非管理员用户发现和利用Docker架构弱点的任何可能性。虽然Portainer有能力禁用一些更常见的漏洞利用，但我们不可能全部阻止，因为可以向容器添加任意数量的功能以尝试获取主机访问权限。此功能只是允许管理员禁用所有可能的入口点。                                                                                                                                                  |
| 为非管理员禁用设备映射        | 阻止用户将主机设备映射到容器中。虽然映射设备的能力通常用于好的目的（例如将GPU映射到容器中），但它同样可以被不可信的授权用户用来将物理存储设备映射到容器中。可以将`/dev/sda1`挂载到容器中，然后从该容器的控制台，用户将不受限制地完全访问sda1设备。通过切换此选项，Portainer阻止非管理员将任何设备映射到容器中。 |
| 为非管理员禁用容器能力 | 切换开启以在非管理员[添加容器](../containers/add.md)时隐藏**容器能力**选项卡。                                                                                                                                                                                                                                                                                                                                                                                                                       |
| 为非管理员禁用sysctl设置        | 切换开启以阻止非管理员用户使用sysctl选项，防止他们重新创建、复制或编辑容器。                                                                                                                                                                                                                                                                                                                                                                                                                            |

## 其他

此部分包含其他各类环境特定设置。

<figure><img src="../..//assets/2.18-host-setup-other.png" alt=""><figcaption></figcaption></figure>

| 选项                                                                    | 概述                                                                                                                                                                                                                        |
| ------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 在UI中显示GPU                                                        | 切换开启以在Portainer UI中启用GPU分配。这会为容器和堆栈列表页面增加额外处理，因此如果您不在环境中使用GPU，我们建议切换此选项关闭。             |
| 添加GPU                                                                   | <p>当<strong>在UI中显示GPU</strong>切换开启时，点击添加GPU将GPU添加到您的环境供容器使用。<br>要添加GPU，请提供GPU的名称和引用GPU的索引或UUID。</p> |
| 为堆栈、服务和容器显示镜像最新指示器 | <p>切换开启为此环境启用<a href="../containers/">新镜像指示器</a>功能。切换关闭禁用该功能。<br><br>此功能仅在Portainer商业版中可用。</p>           |
